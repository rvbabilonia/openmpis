<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Log">
    <!-- Type alias allow you to use a shorter name for long fully qualified class names. -->
    <typeAlias alias="log" type="com.googlecode.openmpis.dto.Log"/>
    
    <cacheModel id="logCache" type="LRU">
        <flushOnExecute statement="insertLog"/>
        <flushInterval hours="24"/>
    </cacheModel>
    
    <!-- Use primitive wrapper type (e.g. Integer) as parameter and allow results to
    be auto-mapped results to Log object (JavaBean) properties -->
    <select id="getAllLogs" resultClass="log" cacheModel="logCache">
        SELECT
        ID as id,
        LOG as log,
        DATE as date,
        FROM log
        ORDER BY ID
    </select>
    
    <select id="getLogById" parameterClass="java.lang.Integer" resultClass="log" cacheModel="logCache">
        <![CDATA[
        SELECT
        LOG as log,
        DATE as date,
        FROM log
        WHERE ID = #id#
        ]]>
    </select>

    <select id="countAllLogs" resultClass="java.lang.Integer" cacheModel="logCache">
        SELECT
        COUNT(ID)
        FROM log
    </select>

    <!-- Use Log object (JavaBean) properties as parameters for insert. Each of the
    parameters in the #hash# symbols is a JavaBeans property. -->
    <insert id="insertLog" parameterClass="log">
        <![CDATA[
        INSERT INTO
        log (LOG, DATE)
        VALUES (#log#, #date#)
        ]]>
    </insert>
</sqlMap>